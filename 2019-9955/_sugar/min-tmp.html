<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns=http://www.w3.org/1999/xhtml><head><meta http-equiv=Content-Type content="text/html; charset=utf-8"><meta http-equiv=Content-Style-Type content=text/css><meta name=generator content=pandoc><title></title><style type=text/css>code{white-space: pre;}</style><link rel=stylesheet href=/home/aaron/.VirtualEnvs/rum/local/lib/python2.7/site-packages/sugar/data/default.css></head><body><h1 id=issue><span class=header-section-number>1</span> Issue</h1><p>A reflected Cross Site Scripting issue was identified on several Zyxel devices, on pages that use the <strong>mp_idx</strong> parameter. The affected pages, included in this report, do not require authentication.</p><h1 id=description><span class=header-section-number>2</span> Description</h1><p>The issue was identified during a Network Penetration Test for a SecurityMetrics, Inc. customer using several Zyxel devices. While investigating devices that appeared on the Port Scan, the analyst noted there were several login pages, similar to the following:</p><figure><img src=./login.png></figure><p><pagebreak></pagebreak></p><p>The analyst referenced Zyxel documentation, such as the <code>web_portal_html_guide.pdf</code>:</p><figure><img src=./access_flow.png></figure><p>To identify what parameters are used and what pages use the parameter. Several pages use the <strong>mp_idx</strong> parameter and include it in the page without validation. A request such as <code>$HOST/weblogin.cgi?mobile=1&amp;mp_idx=&quot;;alert(1);//</code> injects the <strong>mp_idx</strong> parameter in the source of the page:</p><figure><img src=./source.png></figure><p><pagebreak></pagebreak></p><p>The <code>alert</code> is interpreted and triggered when the page is visited:</p><figure><img src=./alert.png></figure><h1 id=affected-pages-and-devices><span class=header-section-number>3</span> Affected Pages and Devices</h1><p>The analyst has verified the following pages are vulnerable:</p><ul><li>weblogin.cgi</li><li>webauth_relogin.cgi</li></ul><p>Additional devices and pages may also be vulnerable, however, this was a black box test. Credentials were not provided, pages requiring authentication were not tested, and additional devices were not available for testing. The following devices are known to be vulnerable:</p><ul><li>ZyWALL 310</li><li>ZyWALL 110</li><li>ATP 500</li><li>USG1900</li><li>USG40</li></ul></body></html>